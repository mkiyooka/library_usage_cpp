[project]
name = "cpp-dev"
version = "0.1.0"
description = "C++ Development Environment"
channels = ["conda-forge"]
platforms = ["linux-64", "osx-64", "osx-arm64", "win-64"]

[dependencies]
# C++ Compiler and Tools (Cross-platform)
# C++17 minimum requirement: clang >= 5.0, gcc >= 7.0, MSVC >= 19.14 (VS2017)
clang = "==21.1.1"  # Latest stable version - available on all platforms
clang-tools = "==21.1.1"  # Includes: clang-tidy, clang-format, clangd
cppcheck = "==2.18.3"  # Static analysis tool
# Build Tools
cmake = "==4.1.1"  # Build system generator
ninja = "==1.13.1"  # Build system
conan = "==2.20.1"  # Package Manager
typos = ">=1.36.3,<2"

[target.osx-arm64.dependencies]
libsodium = "==1.0.20"  # Encryption library
cppzmq = "==4.10.0"  # C++ binding for ZeroMQ
zeromq = "==4.3.5"  # ZeroMQ library

# Linux-specific dependencies (GCC toolchain)
[target.linux-64.dependencies]
gcc = "*"  # GCC compiler
gxx = "*"  # G++ compiler
libgcc-ng = "*"  # GCC runtime library
libstdcxx-ng = "*"  # C++ standard library

# Windows-specific dependencies (GCC/Clang toolchain)
[target.win-64.dependencies]
# Cross-compilation toolchain for Windows
clang_win-64 = "*"  # Clang cross-compiler for Windows
clangxx_win-64 = "*"  # Clang++ cross-compiler for Windows
# MSYS2/MinGW related packages
m2w64-sysroot_win-64 = "*"  # System root for MinGW-w64
m2-gcc-libs = "*"  # GCC runtime libraries
libgcc-devel_win-64 = "*"  # GCC development libraries

[tasks]
# Internal tasks (hidden from pixi task list)
_pixi-install = "pixi install"
_conan-install = "conan install . --output-folder=build --build=missing"
_cmake-config = "cmake --preset=release"
_cmake-config-debug = "cmake --preset=debug"
# Main development tasks
config = { cmd = "pixi run _cmake-config", depends-on = [
  "_pixi-install",
  "_conan-install",
] }
config-debug = { cmd = "pixi run _cmake-config-debug", depends-on = [
  "_pixi-install",
  "_conan-install",
] }
build = "cmake --build build -j"
test = "ctest --test-dir build"
clean = "cmake --build build --target clean"
format = "cmake --build build --target format"
lint = "cmake --build build --target lint"
fullcheck = "cmake --build build --target fullcheck"
